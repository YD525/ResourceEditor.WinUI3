<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="RisohEditorWinUI3Blank.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RisohEditorWinUI3Blank"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:Controls="using:RisohEditorWinUI3Blank.UIExtend"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    mc:Ignorable="d"
    Closed="Window_Closed"
    Title="RisohEditorWinUI3Blank"> 
    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <!--CustomWin-->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="1*"/>
        </Grid.RowDefinitions>

        <!--Tittle-->
        <Controls:WinHeader x:Name="TitleBar" Grid.Row="0"/>

        <Grid x:Name="Form" Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="1*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <CommandBar HorizontalAlignment="Left" VerticalAlignment="Center" VerticalContentAlignment="Center" Background="Transparent" IsOpen="False" DefaultLabelPosition="Collapsed" Height="48">
                    <AppBarButton Icon="OpenFile" Label="Open"/>
                    <AppBarButton Icon="Save" Label="Save"/>
                    <AppBarButton Label="SaveAs">
                        <AppBarButton.Icon>
                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE792;"/>
                        </AppBarButton.Icon>
                    </AppBarButton>
                    <AppBarButton Icon="Import" Label="Import"/>
                    <AppBarButton Label="Import">
                        <AppBarButton.Icon>
                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xEDE1;" />
                        </AppBarButton.Icon>
                    </AppBarButton>
                </CommandBar>
                <AppBarButton Icon="Setting" HorizontalAlignment="Right" Height="40" VerticalAlignment="Center" VerticalContentAlignment="Center" Label="Setting" />
            </Grid>
            <Grid Grid.Row="1" Style="{StaticResource GridColor}">
                <ScrollView VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Auto">

                    <TabView x:Name="Tabs" AddTabButtonClick="AddTab">
                    </TabView>


                </ScrollView>
            </Grid>

            <Grid x:Name="RootGrid" Grid.Row="2" Style="{StaticResource GridColor}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="35"/>
                    <RowDefinition Height="50"/>
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="3*"/>
                    <ColumnDefinition Width="7*"/>
                </Grid.ColumnDefinitions>

               

                <!-- 左侧：树形目录 -->
                <muxc:TreeView x:Name="m_treeView" Grid.Row="2" Grid.Column="0" SelectionChanged="m_treeView_SelectionChanged"  ItemInvoked="NavigationTree_ItemInvoked"/>

                <!-- 右侧：内容区，改为 TabView 并占满整个单元格 -->
                <muxc:TabView
            x:Name="MainTabView"
            Grid.Row="1"
            Grid.Column="1"
            Margin="0"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            IsAddTabButtonVisible="False"
            >

                    <!-- 主文档/编辑页（保留原有绑定显示） -->
                    <muxc:TabViewItem Header="代码" x:Name="DocTab" IsClosable="False">
                        <!-- 在 Border 上保留内边距以提供视觉间距 -->
                        <Border Background="{ThemeResource SystemControlBackgroundAltHighBrush}" CornerRadius="4" Margin="8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <ScrollViewer>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <TextBox IsReadOnly="True" x:Name="m_codeEditor" Text="{Binding ContentText, Mode=OneWay}" TextWrapping="Wrap"/>
                                    <Image Stretch="Uniform" Grid.Column="1" x:Name="image1" />
                                </Grid>
                            </ScrollViewer>
                        </Border>
                    </muxc:TabViewItem>

                    <!-- 示例：属性/视图页（占位） -->
                    <muxc:TabViewItem Header="十六进制" x:Name="PropertiesTab" IsClosable="False">
                        <Border Background="{ThemeResource SystemControlBackgroundAltHighBrush}" CornerRadius="4" Margin="8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <ScrollViewer  HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" >
                                <TextBox x:Name="m_hexViewer" IsReadOnly="True" Text="属性面板占位符" AcceptsReturn="True"/>
                            </ScrollViewer>
                        </Border>
                    </muxc:TabViewItem>
                </muxc:TabView>
            </Grid>

        </Grid>

    </Grid>
</Window>